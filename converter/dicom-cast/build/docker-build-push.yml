# DESCRIPTION: 
# Builds and pushes a docker image for dicom-cast

parameters:
- name: tag
  type: string

steps:
- task: DockerCompose@0
  displayName: 'Build Dicom cast Server Image'
  inputs:
    action: Build services
    azureSubscriptionEndpoint: $(azureSubscriptionEndpoint)
    azureContainerRegistry: $(azureContainerRegistry)
    dockerComposeFile: $(composeLocation)
    dockerComposeFileArgs: nugetpat=$(nuget_pat)
    projectName: linux
    additionalImageTags: ${{parameters.tag}}
    
- task: DockerCompose@0
  displayName: 'Push Dicom cast Server Image'
  inputs:
    action: Push services
    azureSubscriptionEndpoint: $(azureSubscriptionEndpoint)
    azureContainerRegistry: $(azureContainerRegistry)
    dockerComposeFile: $(composeLocation)
    projectName: linux
    additionalImageTags: ${{parameters.tag}}