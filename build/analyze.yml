steps:
- task: AntiMalware@3
  inputs:
    InputType: 'Basic'
    ScanType: 'CustomScan'
    FileDirPath: '$(Build.SourcesDirectory)'
    EnableServices: true
    TreatSignatureUpdateFailureAs: 'Standard'
    SignatureFreshness: 'OneDay'
    TreatStaleSignatureAs: 'Error'

- task: Armory@2
  inputs:
    targetDirectory: '$(Build.SourcesDirectory)\samples\templates'
    targetFiles: 'f|*.json'

- task: BinSkim@4
  inputs:
    InputType: 'Basic'
    Function: 'analyze'
    AnalyzeTargetGlob: '+:file|$(Build.SourcesDirectory)\**\bin\**\Microsoft.Health.Dicom*.dll;+:file|$(Build.SourcesDirectory)\**\bin\**\Microsoft.Health.Dicom*.exe'

- task: CredScan@2
  inputs:
    scanFolder: '$(Build.SourcesDirectory)'
    toolMajorVersion: 'V1'
    outputFormat: 'sarif'